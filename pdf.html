<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pdf Viewer</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link href="https://fonts.googleapis.com/css2?family=Merriweather:ital,wght@0,300;0,400;0,700;0,900;1,400&family=Inter:wght@400;500;600&display=swap" rel="stylesheet">
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        serif: ['Merriweather', 'serif'],
                        sans: ['Inter', 'sans-serif'],
                    },
                    boxShadow: {
                        'page': '0 20px 40px -5px rgba(0, 0, 0, 0.3), 0 10px 20px -5px rgba(0,0,0,0.1)',
                    }
                }
            }
        }
    </script>

    <style>
        /* Nền xám chuyên nghiệp */
        body { background-color: #3e4144; overflow-x: hidden; }
        
        /* Hiệu ứng trang giấy thật */
        .page-container {
            width: 210mm;
            min-height: 297mm;
            margin: 40px auto;
            background: white;
            padding: 25mm 20mm;
            position: relative;
            transform-origin: top center; /* Quan trọng để zoom từ giữa */
            transition: transform 0.2s ease-out; /* Hiệu ứng zoom mượt */
        }

        /* Thanh cuộn mượt mà */
        html { scroll-behavior: smooth; }

        /* Scrollbar tùy chỉnh */
        ::-webkit-scrollbar { width: 10px; }
        ::-webkit-scrollbar-track { background: #2d3032; }
        ::-webkit-scrollbar-thumb { background: #5f6368; border-radius: 5px; }
        ::-webkit-scrollbar-thumb:hover { background: #767a7f; }

        /* Đáp án đúng: Hiệu ứng bút nhớ */
        .correct-answer { 
            color: #b91c1c; /* Đỏ đậm */
            font-weight: 700;
            background-color: #fee2e2; /* Nền đỏ rất nhạt */
            padding: 2px 8px;
            border-radius: 6px;
            border: 1px solid #fecaca;
            display: inline-block;
            transition: all 0.2s ease;
        }
        .correct-answer:hover {
            transform: scale(1.02);
            background-color: #fca5a5;
        }

        /* Skeleton Loading Animation */
        .skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
            border-radius: 4px;
        }
        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        /* Chế độ in ấn */
        @media print {
            body { background: white; margin: 0; overflow: visible; }
            .no-print { display: none !important; }
            .page-container { 
                margin: 0; box-shadow: none; width: 100%; 
                padding: 15mm; border: none; transform: none !important;
            }
            .correct-answer { border: none; background: transparent; color: black; text-decoration: underline; }
        }
    </style>
</head>
<body class="font-serif antialiased text-slate-800">

    <div class="fixed top-0 left-0 h-1 bg-gradient-to-r from-sky-400 to-indigo-500 z-[60] w-0 transition-all duration-100 ease-out no-print" id="progress-bar"></div>

    <div class="fixed top-0 left-0 w-full h-16 bg-slate-900/90 backdrop-blur-md border-b border-white/10 flex justify-between items-center px-4 sm:px-6 z-50 shadow-lg no-print transition-all duration-300" id="toolbar">
        
        <div class="flex items-center gap-3 sm:gap-4 flex-1">
            <a href="index.html" class="flex items-center gap-2 text-slate-300 hover:text-white hover:bg-white/10 px-2 py-2 rounded-lg transition-all group">
                <i class="ph-bold ph-arrow-left text-xl group-hover:-translate-x-1 transition-transform"></i>
                <span class="font-sans font-medium hidden lg:inline">Quay lại</span>
            </a>
            <div class="h-6 w-px bg-white/20 hidden sm:block"></div>
            <div class="flex flex-col truncate">
                <span class="text-white font-sans font-semibold text-sm truncate">questions.txt</span>
            </div>
        </div>

        <div class="flex items-center gap-1 bg-black/30 rounded-full p-1 border border-white/10 mx-2">
            <button onclick="zoomOut()" class="w-8 h-8 flex items-center justify-center text-slate-300 hover:text-white hover:bg-white/10 rounded-full transition-colors" title="Thu nhỏ">
                <i class="ph-bold ph-minus"></i>
            </button>
            <span id="zoom-level" class="font-sans text-xs text-white font-medium w-10 text-center select-none">100%</span>
            <button onclick="zoomIn()" class="w-8 h-8 flex items-center justify-center text-slate-300 hover:text-white hover:bg-white/10 rounded-full transition-colors" title="Phóng to">
                <i class="ph-bold ph-plus"></i>
            </button>
        </div>

        <div class="flex items-center gap-3 flex-1 justify-end">
            <div class="text-slate-400 text-xs font-sans hidden xl:block">
                <span id="question-count">...</span> câu
            </div>
            <button onclick="window.print()" class="flex items-center gap-2 bg-emerald-600 hover:bg-emerald-500 text-white font-sans text-sm font-medium px-4 py-2 rounded-full shadow-lg shadow-emerald-900/20 transition-all hover:shadow-emerald-500/30 active:scale-95">
                <i class="ph-bold ph-printer"></i>
                <span class="hidden sm:inline">In</span>
            </button>
        </div>
    </div>

    <div class="pt-20 pb-20 flex justify-center min-h-screen overflow-hidden">
        <div class="page-container shadow-page rounded-sm" id="main-page">
            
            <div class="text-center border-b-2 border-slate-800 pb-6 mb-10">
                <div class="flex justify-center mb-4 text-sky-600 text-4xl">
                    <i class="ph-duotone ph-book-bookmark"></i>
                </div>
                <h1 class="text-3xl font-black uppercase tracking-tight text-slate-900 mb-2 font-sans">Ngân Hàng Câu Hỏi</h1>
                <div class="flex justify-center items-center gap-2 text-sm text-slate-500 italic font-sans">
                    <span>Sai sót liên hệ Zalo : 0325591025</span>
                </div>
            </div>

            <div id="content-body" class="space-y-8">
                <div class="space-y-6">
                    <div class="h-6 bg-gray-200 rounded w-3/4 skeleton"></div>
                    <div class="space-y-3 pl-6">
                        <div class="h-4 bg-gray-100 rounded w-1/2 skeleton"></div>
                        <div class="h-4 bg-gray-100 rounded w-2/3 skeleton"></div>
                        <div class="h-4 bg-gray-100 rounded w-1/3 skeleton"></div>
                    </div>
                </div>
            </div>
            
            <div class="mt-16 pt-8 border-t border-slate-200 flex justify-between items-end">
                <div class="text-[10px] text-slate-400 font-sans uppercase tracking-widest">
                    Generated by Quiz System
                </div>
                <div class="w-8 h-8 rounded-full border border-slate-300 flex items-center justify-center text-xs text-slate-400 font-sans">
                    1
                </div>
            </div>
        </div>
    </div>

    <button onclick="window.scrollTo(0,0)" id="backToTop" class="fixed bottom-8 right-8 bg-slate-800 text-white p-3 rounded-full shadow-xl translate-y-20 opacity-0 transition-all duration-300 hover:bg-sky-600 z-50 no-print">
        <i class="ph-bold ph-arrow-up text-xl"></i>
    </button>

    <script>
        // --- XỬ LÝ ZOOM ---
        let currentZoom = 100;
        const page = document.getElementById('main-page');
        const zoomLabel = document.getElementById('zoom-level');

        function updateZoom() {
            // Sử dụng Transform Scale để phóng to/thu nhỏ
            page.style.transform = `scale(${currentZoom / 100})`;
            zoomLabel.innerText = `${currentZoom}%`;
            
            // Điều chỉnh Margin để khi phóng to không bị che mất nội dung ở dưới (UX Fix)
            if(currentZoom > 100) {
                page.style.marginBottom = `${(currentZoom - 100) * 3}mm`;
            } else {
                page.style.marginBottom = '40px';
            }
        }

        function zoomIn() {
            if (currentZoom < 200) { // Giới hạn max 200%
                currentZoom += 10;
                updateZoom();
            }
        }

        function zoomOut() {
            if (currentZoom > 50) { // Giới hạn min 50%
                currentZoom -= 10;
                updateZoom();
            }
        }

        // --- XỬ LÝ SCROLL & LOAD FILE (Code cũ) ---
        window.onscroll = function() {
            let winScroll = document.body.scrollTop || document.documentElement.scrollTop;
            let height = document.documentElement.scrollHeight - document.documentElement.clientHeight;
            let scrolled = (winScroll / height) * 100;
            document.getElementById("progress-bar").style.width = scrolled + "%";

            const btn = document.getElementById("backToTop");
            if (winScroll > 500) {
                btn.classList.remove("translate-y-20", "opacity-0");
            } else {
                btn.classList.add("translate-y-20", "opacity-0");
            }
        };

        async function loadAndParse() {
            try {
                await new Promise(r => setTimeout(r, 800));
                const response = await fetch('questions.txt');
                if (!response.ok) throw new Error("Không tìm thấy file questions.txt");
                
                const text = await response.text();
                const container = document.getElementById('content-body');
                const countLabel = document.getElementById('question-count');

                const lines = text.split('\n');
                let html = '';
                let currentQuestion = null;
                let questionCount = 0;
                
                const questionNumRegex = /^(\d+)\.?\s*$/; 
                const optionRegex = /^(\*)?([A-D])\./; 
                let isCollectingOptions = false;

                for (let i = 0; i < lines.length; i++) {
                    let line = lines[i].trim();
                    if (!line) continue;

                    let numMatch = line.match(questionNumRegex);

                    if (numMatch) {
                        if (currentQuestion) {
                            html += renderQuestion(currentQuestion);
                            questionCount++;
                        }
                        currentQuestion = { number: numMatch[1], content: "", options: [] };
                        isCollectingOptions = false;
                        continue;
                    }

                    let optMatch = line.match(optionRegex);
                    if (optMatch) {
                        isCollectingOptions = true;
                        if (currentQuestion) {
                            currentQuestion.options.push({
                                isCorrect: !!optMatch[1], 
                                text: line.replace('*', '') 
                            });
                        }
                    } else {
                        if (currentQuestion && !isCollectingOptions) {
                            currentQuestion.content += (currentQuestion.content ? " " : "") + line;
                        } else if (currentQuestion && isCollectingOptions) {
                            let lastOpt = currentQuestion.options[currentQuestion.options.length - 1];
                            if (lastOpt) lastOpt.text += " " + line;
                        }
                    }
                }

                if (currentQuestion) {
                    html += renderQuestion(currentQuestion);
                    questionCount++;
                }

                container.innerHTML = html;
                countLabel.innerText = questionCount;

            } catch (e) {
                document.getElementById('content-body').innerHTML = 
                    `<div class="p-4 bg-red-50 border border-red-200 rounded-lg text-red-600 text-center font-sans">
                        <i class="ph-bold ph-warning text-2xl mb-2"></i><br>
                        Lỗi: ${e.message}
                    </div>`;
            }
        }

        function renderQuestion(q) {
            let optionsHtml = q.options.map(opt => {
                const correctClass = opt.isCorrect ? 'correct-answer' : 'text-slate-600 group-hover:text-slate-900';
                const icon = opt.isCorrect ? '<i class="ph-fill ph-check-circle inline-block mr-1"></i>' : '';
                
                return `
                    <div class="mb-2 pl-4 flex items-start group transition-colors">
                        <span class="${correctClass} text-[15px] leading-relaxed">
                            ${icon}${opt.text}
                        </span>
                    </div>
                `;
            }).join('');

            return `
                <div class="pb-6 border-b border-slate-100 last:border-0 hover:bg-slate-50 p-4 -mx-4 rounded-xl transition-colors duration-200">
                    <h3 class="text-lg font-bold text-slate-800 mb-3 leading-snug flex gap-2">
                        <span class="flex-shrink-0 w-8 h-8 bg-slate-800 text-white rounded-lg flex items-center justify-center text-sm font-sans shadow-md shadow-slate-300">
                            ${q.number}
                        </span>
                        <span>${q.content}</span>
                    </h3>
                    <div class="font-serif">
                        ${optionsHtml}
                    </div>
                </div>
            `;
        }

        window.onload = loadAndParse;
    </script>
</body>
</html>
